{"ast":null,"code":"var __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from) {\n  for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];\n\n  return to;\n};\n\nimport { useEffect, useRef } from 'react';\nimport useIsomorphicLayoutEffect from 'use-isomorphic-layout-effect';\nimport { ReactEffectType } from './types';\nimport { partition } from './utils';\n\nfunction executeEffect(action, state) {\n  var exec = action.exec;\n  var originalExec = exec(state.context, state._event.data, {\n    action: action,\n    state: state,\n    _event: state._event\n  });\n  originalExec();\n}\n\nexport function useReactEffectActions(service) {\n  var effectActionsRef = useRef([]);\n  var layoutEffectActionsRef = useRef([]);\n  useIsomorphicLayoutEffect(function () {\n    var sub = service.subscribe(function (currentState) {\n      var _a, _b;\n\n      if (currentState.actions.length) {\n        var reactEffectActions = currentState.actions.filter(function (action) {\n          return typeof action.exec === 'function' && '__effect' in action.exec;\n        });\n\n        var _c = __read(partition(reactEffectActions, function (action) {\n          return action.exec.__effect === ReactEffectType.Effect;\n        }), 2),\n            effectActions = _c[0],\n            layoutEffectActions = _c[1];\n\n        (_a = effectActionsRef.current).push.apply(_a, __spreadArray([], __read(effectActions.map(function (effectAction) {\n          return [effectAction, currentState];\n        }))));\n\n        (_b = layoutEffectActionsRef.current).push.apply(_b, __spreadArray([], __read(layoutEffectActions.map(function (layoutEffectAction) {\n          return [layoutEffectAction, currentState];\n        }))));\n      }\n    });\n    return function () {\n      sub.unsubscribe();\n    };\n  }, []); // this is somewhat weird - this should always be flushed within useLayoutEffect\n  // but we don't want to receive warnings about useLayoutEffect being used on the server\n  // so we have to use `useIsomorphicLayoutEffect` to silence those warnings\n\n  useIsomorphicLayoutEffect(function () {\n    while (layoutEffectActionsRef.current.length) {\n      var _a = __read(layoutEffectActionsRef.current.shift(), 2),\n          layoutEffectAction = _a[0],\n          effectState = _a[1];\n\n      executeEffect(layoutEffectAction, effectState);\n    }\n  }); // https://github.com/davidkpiano/xstate/pull/1202#discussion_r429677773\n\n  useEffect(function () {\n    while (effectActionsRef.current.length) {\n      var _a = __read(effectActionsRef.current.shift(), 2),\n          effectAction = _a[0],\n          effectState = _a[1];\n\n      executeEffect(effectAction, effectState);\n    }\n  });\n}","map":{"version":3,"sources":["/Users/macbook/_myProject/campustaxi-2-webview/node_modules/@xstate/react/es/useReactEffectActions.js"],"names":["__read","o","n","m","Symbol","iterator","i","call","r","ar","e","next","done","push","value","error","__spreadArray","to","from","il","length","j","useEffect","useRef","useIsomorphicLayoutEffect","ReactEffectType","partition","executeEffect","action","state","exec","originalExec","context","_event","data","useReactEffectActions","service","effectActionsRef","layoutEffectActionsRef","sub","subscribe","currentState","_a","_b","actions","reactEffectActions","filter","_c","__effect","Effect","effectActions","layoutEffectActions","current","apply","map","effectAction","layoutEffectAction","unsubscribe","shift","effectState"],"mappings":"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","sourcesContent":["var __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nimport { useEffect, useRef } from 'react';\nimport useIsomorphicLayoutEffect from 'use-isomorphic-layout-effect';\nimport { ReactEffectType } from './types';\nimport { partition } from './utils';\nfunction executeEffect(action, state) {\n    var exec = action.exec;\n    var originalExec = exec(state.context, state._event.data, {\n        action: action,\n        state: state,\n        _event: state._event\n    });\n    originalExec();\n}\nexport function useReactEffectActions(service) {\n    var effectActionsRef = useRef([]);\n    var layoutEffectActionsRef = useRef([]);\n    useIsomorphicLayoutEffect(function () {\n        var sub = service.subscribe(function (currentState) {\n            var _a, _b;\n            if (currentState.actions.length) {\n                var reactEffectActions = currentState.actions.filter(function (action) {\n                    return (typeof action.exec === 'function' &&\n                        '__effect' in action.exec);\n                });\n                var _c = __read(partition(reactEffectActions, function (action) {\n                    return action.exec.__effect === ReactEffectType.Effect;\n                }), 2), effectActions = _c[0], layoutEffectActions = _c[1];\n                (_a = effectActionsRef.current).push.apply(_a, __spreadArray([], __read(effectActions.map(function (effectAction) { return [effectAction, currentState]; }))));\n                (_b = layoutEffectActionsRef.current).push.apply(_b, __spreadArray([], __read(layoutEffectActions.map(function (layoutEffectAction) { return [layoutEffectAction, currentState]; }))));\n            }\n        });\n        return function () {\n            sub.unsubscribe();\n        };\n    }, []);\n    // this is somewhat weird - this should always be flushed within useLayoutEffect\n    // but we don't want to receive warnings about useLayoutEffect being used on the server\n    // so we have to use `useIsomorphicLayoutEffect` to silence those warnings\n    useIsomorphicLayoutEffect(function () {\n        while (layoutEffectActionsRef.current.length) {\n            var _a = __read(layoutEffectActionsRef.current.shift(), 2), layoutEffectAction = _a[0], effectState = _a[1];\n            executeEffect(layoutEffectAction, effectState);\n        }\n    }); // https://github.com/davidkpiano/xstate/pull/1202#discussion_r429677773\n    useEffect(function () {\n        while (effectActionsRef.current.length) {\n            var _a = __read(effectActionsRef.current.shift(), 2), effectAction = _a[0], effectState = _a[1];\n            executeEffect(effectAction, effectState);\n        }\n    });\n}\n"]},"metadata":{},"sourceType":"module"}