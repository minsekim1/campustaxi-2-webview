{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _tslib = require('./_virtual/_tslib.js');\n\nvar constants = require('./constants.js');\n\nvar environment = require('./environment.js');\n\nfunction keys(value) {\n  return Object.keys(value);\n}\n\nfunction matchesState(parentStateId, childStateId, delimiter) {\n  if (delimiter === void 0) {\n    delimiter = constants.STATE_DELIMITER;\n  }\n\n  var parentStateValue = toStateValue(parentStateId, delimiter);\n  var childStateValue = toStateValue(childStateId, delimiter);\n\n  if (isString(childStateValue)) {\n    if (isString(parentStateValue)) {\n      return childStateValue === parentStateValue;\n    } // Parent more specific than child\n\n\n    return false;\n  }\n\n  if (isString(parentStateValue)) {\n    return parentStateValue in childStateValue;\n  }\n\n  return keys(parentStateValue).every(function (key) {\n    if (!(key in childStateValue)) {\n      return false;\n    }\n\n    return matchesState(parentStateValue[key], childStateValue[key]);\n  });\n}\n\nfunction getEventType(event) {\n  try {\n    return isString(event) || typeof event === 'number' ? \"\" + event : event.type;\n  } catch (e) {\n    throw new Error('Events must be strings or objects with a string event.type property.');\n  }\n}\n\nfunction toStatePath(stateId, delimiter) {\n  try {\n    if (isArray(stateId)) {\n      return stateId;\n    }\n\n    return stateId.toString().split(delimiter);\n  } catch (e) {\n    throw new Error(\"'\" + stateId + \"' is not a valid state path.\");\n  }\n}\n\nfunction isStateLike(state) {\n  return typeof state === 'object' && 'value' in state && 'context' in state && 'event' in state && '_event' in state;\n}\n\nfunction toStateValue(stateValue, delimiter) {\n  if (isStateLike(stateValue)) {\n    return stateValue.value;\n  }\n\n  if (isArray(stateValue)) {\n    return pathToStateValue(stateValue);\n  }\n\n  if (typeof stateValue !== 'string') {\n    return stateValue;\n  }\n\n  var statePath = toStatePath(stateValue, delimiter);\n  return pathToStateValue(statePath);\n}\n\nfunction pathToStateValue(statePath) {\n  if (statePath.length === 1) {\n    return statePath[0];\n  }\n\n  var value = {};\n  var marker = value;\n\n  for (var i = 0; i < statePath.length - 1; i++) {\n    if (i === statePath.length - 2) {\n      marker[statePath[i]] = statePath[i + 1];\n    } else {\n      marker[statePath[i]] = {};\n      marker = marker[statePath[i]];\n    }\n  }\n\n  return value;\n}\n\nfunction mapValues(collection, iteratee) {\n  var result = {};\n  var collectionKeys = keys(collection);\n\n  for (var i = 0; i < collectionKeys.length; i++) {\n    var key = collectionKeys[i];\n    result[key] = iteratee(collection[key], key, collection, i);\n  }\n\n  return result;\n}\n\nfunction mapFilterValues(collection, iteratee, predicate) {\n  var e_1, _a;\n\n  var result = {};\n\n  try {\n    for (var _b = _tslib.__values(keys(collection)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var item = collection[key];\n\n      if (!predicate(item)) {\n        continue;\n      }\n\n      result[key] = iteratee(item, key, collection);\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return result;\n}\n/**\r\n * Retrieves a value at the given path.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nvar path = function (props) {\n  return function (object) {\n    var e_2, _a;\n\n    var result = object;\n\n    try {\n      for (var props_1 = _tslib.__values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n        var prop = props_1_1.value;\n        result = result[prop];\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    return result;\n  };\n};\n/**\r\n * Retrieves a value at the given path via the nested accessor prop.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nfunction nestedPath(props, accessorProp) {\n  return function (object) {\n    var e_3, _a;\n\n    var result = object;\n\n    try {\n      for (var props_2 = _tslib.__values(props), props_2_1 = props_2.next(); !props_2_1.done; props_2_1 = props_2.next()) {\n        var prop = props_2_1.value;\n        result = result[accessorProp][prop];\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (props_2_1 && !props_2_1.done && (_a = props_2.return)) _a.call(props_2);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    return result;\n  };\n}\n\nfunction toStatePaths(stateValue) {\n  if (!stateValue) {\n    return [[]];\n  }\n\n  if (isString(stateValue)) {\n    return [[stateValue]];\n  }\n\n  var result = flatten(keys(stateValue).map(function (key) {\n    var subStateValue = stateValue[key];\n\n    if (typeof subStateValue !== 'string' && (!subStateValue || !Object.keys(subStateValue).length)) {\n      return [[key]];\n    }\n\n    return toStatePaths(stateValue[key]).map(function (subPath) {\n      return [key].concat(subPath);\n    });\n  }));\n  return result;\n}\n\nfunction flatten(array) {\n  var _a;\n\n  return (_a = []).concat.apply(_a, _tslib.__spreadArray([], _tslib.__read(array)));\n}\n\nfunction toArrayStrict(value) {\n  if (isArray(value)) {\n    return value;\n  }\n\n  return [value];\n}\n\nfunction toArray(value) {\n  if (value === undefined) {\n    return [];\n  }\n\n  return toArrayStrict(value);\n}\n\nfunction mapContext(mapper, context, _event) {\n  var e_5, _a;\n\n  if (isFunction(mapper)) {\n    return mapper(context, _event.data);\n  }\n\n  var result = {};\n\n  try {\n    for (var _b = _tslib.__values(Object.keys(mapper)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var subMapper = mapper[key];\n\n      if (isFunction(subMapper)) {\n        result[key] = subMapper(context, _event.data);\n      } else {\n        result[key] = subMapper;\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return result;\n}\n\nfunction isBuiltInEvent(eventType) {\n  return /^(done|error)\\./.test(eventType);\n}\n\nfunction isPromiseLike(value) {\n  if (value instanceof Promise) {\n    return true;\n  } // Check if shape matches the Promise/A+ specification for a \"thenable\".\n\n\n  if (value !== null && (isFunction(value) || typeof value === 'object') && isFunction(value.then)) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction isBehavior(value) {\n  return value !== null && typeof value === 'object' && 'transition' in value && typeof value.transition === 'function';\n}\n\nfunction partition(items, predicate) {\n  var e_6, _a;\n\n  var _b = _tslib.__read([[], []], 2),\n      truthy = _b[0],\n      falsy = _b[1];\n\n  try {\n    for (var items_1 = _tslib.__values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n      var item = items_1_1.value;\n\n      if (predicate(item)) {\n        truthy.push(item);\n      } else {\n        falsy.push(item);\n      }\n    }\n  } catch (e_6_1) {\n    e_6 = {\n      error: e_6_1\n    };\n  } finally {\n    try {\n      if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n    } finally {\n      if (e_6) throw e_6.error;\n    }\n  }\n\n  return [truthy, falsy];\n}\n\nfunction updateHistoryStates(hist, stateValue) {\n  return mapValues(hist.states, function (subHist, key) {\n    if (!subHist) {\n      return undefined;\n    }\n\n    var subStateValue = (isString(stateValue) ? undefined : stateValue[key]) || (subHist ? subHist.current : undefined);\n\n    if (!subStateValue) {\n      return undefined;\n    }\n\n    return {\n      current: subStateValue,\n      states: updateHistoryStates(subHist, subStateValue)\n    };\n  });\n}\n\nfunction updateHistoryValue(hist, stateValue) {\n  return {\n    current: stateValue,\n    states: updateHistoryStates(hist, stateValue)\n  };\n}\n\nfunction updateContext(context, _event, assignActions, state) {\n  if (!environment.IS_PRODUCTION) {\n    exports.warn(!!context, 'Attempting to update undefined context');\n  }\n\n  var updatedContext = context ? assignActions.reduce(function (acc, assignAction) {\n    var e_7, _a;\n\n    var assignment = assignAction.assignment;\n    var meta = {\n      state: state,\n      action: assignAction,\n      _event: _event\n    };\n    var partialUpdate = {};\n\n    if (isFunction(assignment)) {\n      partialUpdate = assignment(acc, _event.data, meta);\n    } else {\n      try {\n        for (var _b = _tslib.__values(keys(assignment)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var key = _c.value;\n          var propAssignment = assignment[key];\n          partialUpdate[key] = isFunction(propAssignment) ? propAssignment(acc, _event.data, meta) : propAssignment;\n        }\n      } catch (e_7_1) {\n        e_7 = {\n          error: e_7_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_7) throw e_7.error;\n        }\n      }\n    }\n\n    return Object.assign({}, acc, partialUpdate);\n  }, context) : context;\n  return updatedContext;\n} // tslint:disable-next-line:no-empty\n\n\nexports.warn = function () {};\n\nif (!environment.IS_PRODUCTION) {\n  exports.warn = function (condition, message) {\n    var error = condition instanceof Error ? condition : undefined;\n\n    if (!error && condition) {\n      return;\n    }\n\n    if (console !== undefined) {\n      var args = [\"Warning: \" + message];\n\n      if (error) {\n        args.push(error);\n      } // tslint:disable-next-line:no-console\n\n\n      console.warn.apply(console, args);\n    }\n  };\n}\n\nfunction isArray(value) {\n  return Array.isArray(value);\n} // tslint:disable-next-line:ban-types\n\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n\nfunction isString(value) {\n  return typeof value === 'string';\n} // export function memoizedGetter<T, TP extends { prototype: object }>(\n//   o: TP,\n//   property: string,\n//   getter: () => T\n// ): void {\n//   Object.defineProperty(o.prototype, property, {\n//     get: getter,\n//     enumerable: false,\n//     configurable: false\n//   });\n// }\n\n\nfunction toGuard(condition, guardMap) {\n  if (!condition) {\n    return undefined;\n  }\n\n  if (isString(condition)) {\n    return {\n      type: constants.DEFAULT_GUARD_TYPE,\n      name: condition,\n      predicate: guardMap ? guardMap[condition] : undefined\n    };\n  }\n\n  if (isFunction(condition)) {\n    return {\n      type: constants.DEFAULT_GUARD_TYPE,\n      name: condition.name,\n      predicate: condition\n    };\n  }\n\n  return condition;\n}\n\nfunction isObservable(value) {\n  try {\n    return 'subscribe' in value && isFunction(value.subscribe);\n  } catch (e) {\n    return false;\n  }\n}\n\nvar symbolObservable = /*#__PURE__*/function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n\nfunction isMachine(value) {\n  try {\n    return '__xstatenode' in value;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction isActor(value) {\n  return !!value && typeof value.send === 'function';\n}\n\nvar uniqueId = /*#__PURE__*/function () {\n  var currentId = 0;\n  return function () {\n    currentId++;\n    return currentId.toString(16);\n  };\n}();\n\nfunction toEventObject(event, payload // id?: TEvent['type']\n) {\n  if (isString(event) || typeof event === 'number') {\n    return _tslib.__assign({\n      type: event\n    }, payload);\n  }\n\n  return event;\n}\n\nfunction toSCXMLEvent(event, scxmlEvent) {\n  if (!isString(event) && '$$type' in event && event.$$type === 'scxml') {\n    return event;\n  }\n\n  var eventObject = toEventObject(event);\n  return _tslib.__assign({\n    name: eventObject.type,\n    data: eventObject,\n    $$type: 'scxml',\n    type: 'external'\n  }, scxmlEvent);\n}\n\nfunction toTransitionConfigArray(event, configLike) {\n  var transitions = toArrayStrict(configLike).map(function (transitionLike) {\n    if (typeof transitionLike === 'undefined' || typeof transitionLike === 'string' || isMachine(transitionLike)) {\n      return {\n        target: transitionLike,\n        event: event\n      };\n    }\n\n    return _tslib.__assign(_tslib.__assign({}, transitionLike), {\n      event: event\n    });\n  });\n  return transitions;\n}\n\nfunction normalizeTarget(target) {\n  if (target === undefined || target === constants.TARGETLESS_KEY) {\n    return undefined;\n  }\n\n  return toArray(target);\n}\n\nfunction reportUnhandledExceptionOnInvocation(originalError, currentError, id) {\n  if (!environment.IS_PRODUCTION) {\n    var originalStackTrace = originalError.stack ? \" Stacktrace was '\" + originalError.stack + \"'\" : '';\n\n    if (originalError === currentError) {\n      // tslint:disable-next-line:no-console\n      console.error(\"Missing onError handler for invocation '\" + id + \"', error was '\" + originalError + \"'.\" + originalStackTrace);\n    } else {\n      var stackTrace = currentError.stack ? \" Stacktrace was '\" + currentError.stack + \"'\" : ''; // tslint:disable-next-line:no-console\n\n      console.error(\"Missing onError handler and/or unhandled exception/promise rejection for invocation '\" + id + \"'. \" + (\"Original error: '\" + originalError + \"'. \" + originalStackTrace + \" Current error is '\" + currentError + \"'.\" + stackTrace));\n    }\n  }\n}\n\nfunction evaluateGuard(machine, guard, context, _event, state) {\n  var guards = machine.options.guards;\n  var guardMeta = {\n    state: state,\n    cond: guard,\n    _event: _event\n  }; // TODO: do not hardcode!\n\n  if (guard.type === constants.DEFAULT_GUARD_TYPE) {\n    return ((guards === null || guards === void 0 ? void 0 : guards[guard.name]) || guard.predicate)(context, _event.data, guardMeta);\n  }\n\n  var condFn = guards[guard.type];\n\n  if (!condFn) {\n    throw new Error(\"Guard '\" + guard.type + \"' is not implemented on machine '\" + machine.id + \"'.\");\n  }\n\n  return condFn(context, _event.data, guardMeta);\n}\n\nfunction toInvokeSource(src) {\n  if (typeof src === 'string') {\n    return {\n      type: src\n    };\n  }\n\n  return src;\n}\n\nfunction toObserver(nextHandler, errorHandler, completionHandler) {\n  if (typeof nextHandler === 'object') {\n    return nextHandler;\n  }\n\n  var noop = function () {\n    return void 0;\n  };\n\n  return {\n    next: nextHandler,\n    error: errorHandler || noop,\n    complete: completionHandler || noop\n  };\n}\n\nexports.evaluateGuard = evaluateGuard;\nexports.flatten = flatten;\nexports.getEventType = getEventType;\nexports.isActor = isActor;\nexports.isArray = isArray;\nexports.isBehavior = isBehavior;\nexports.isBuiltInEvent = isBuiltInEvent;\nexports.isFunction = isFunction;\nexports.isMachine = isMachine;\nexports.isObservable = isObservable;\nexports.isPromiseLike = isPromiseLike;\nexports.isStateLike = isStateLike;\nexports.isString = isString;\nexports.keys = keys;\nexports.mapContext = mapContext;\nexports.mapFilterValues = mapFilterValues;\nexports.mapValues = mapValues;\nexports.matchesState = matchesState;\nexports.nestedPath = nestedPath;\nexports.normalizeTarget = normalizeTarget;\nexports.partition = partition;\nexports.path = path;\nexports.pathToStateValue = pathToStateValue;\nexports.reportUnhandledExceptionOnInvocation = reportUnhandledExceptionOnInvocation;\nexports.symbolObservable = symbolObservable;\nexports.toArray = toArray;\nexports.toArrayStrict = toArrayStrict;\nexports.toEventObject = toEventObject;\nexports.toGuard = toGuard;\nexports.toInvokeSource = toInvokeSource;\nexports.toObserver = toObserver;\nexports.toSCXMLEvent = toSCXMLEvent;\nexports.toStatePath = toStatePath;\nexports.toStatePaths = toStatePaths;\nexports.toStateValue = toStateValue;\nexports.toTransitionConfigArray = toTransitionConfigArray;\nexports.uniqueId = uniqueId;\nexports.updateContext = updateContext;\nexports.updateHistoryStates = updateHistoryStates;\nexports.updateHistoryValue = updateHistoryValue;","map":{"version":3,"sources":["/Users/macbook/_myProject/campustaxi-2-webview/node_modules/xstate/lib/utils.js"],"names":["Object","defineProperty","exports","value","_tslib","require","constants","environment","keys","matchesState","parentStateId","childStateId","delimiter","STATE_DELIMITER","parentStateValue","toStateValue","childStateValue","isString","every","key","getEventType","event","type","e","Error","toStatePath","stateId","isArray","toString","split","isStateLike","state","stateValue","pathToStateValue","statePath","length","marker","i","mapValues","collection","iteratee","result","collectionKeys","mapFilterValues","predicate","e_1","_a","_b","__values","_c","next","done","item","e_1_1","error","return","call","path","props","object","e_2","props_1","props_1_1","prop","e_2_1","nestedPath","accessorProp","e_3","props_2","props_2_1","e_3_1","toStatePaths","flatten","map","subStateValue","subPath","concat","array","apply","__spreadArray","__read","toArrayStrict","toArray","undefined","mapContext","mapper","context","_event","e_5","isFunction","data","subMapper","e_5_1","isBuiltInEvent","eventType","test","isPromiseLike","Promise","then","isBehavior","transition","partition","items","e_6","truthy","falsy","items_1","items_1_1","push","e_6_1","updateHistoryStates","hist","states","subHist","current","updateHistoryValue","updateContext","assignActions","IS_PRODUCTION","warn","updatedContext","reduce","acc","assignAction","e_7","assignment","meta","action","partialUpdate","propAssignment","e_7_1","assign","condition","message","console","args","Array","toGuard","guardMap","DEFAULT_GUARD_TYPE","name","isObservable","subscribe","symbolObservable","Symbol","observable","isMachine","isActor","send","uniqueId","currentId","toEventObject","payload","__assign","toSCXMLEvent","scxmlEvent","$$type","eventObject","toTransitionConfigArray","configLike","transitions","transitionLike","target","normalizeTarget","TARGETLESS_KEY","reportUnhandledExceptionOnInvocation","originalError","currentError","id","originalStackTrace","stack","stackTrace","evaluateGuard","machine","guard","guards","options","guardMeta","cond","condFn","toInvokeSource","src","toObserver","nextHandler","errorHandler","completionHandler","noop","complete"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar _tslib = require('./_virtual/_tslib.js');\nvar constants = require('./constants.js');\nvar environment = require('./environment.js');\n\nfunction keys(value) {\n  return Object.keys(value);\n}\nfunction matchesState(parentStateId, childStateId, delimiter) {\n  if (delimiter === void 0) {\n    delimiter = constants.STATE_DELIMITER;\n  }\n\n  var parentStateValue = toStateValue(parentStateId, delimiter);\n  var childStateValue = toStateValue(childStateId, delimiter);\n\n  if (isString(childStateValue)) {\n    if (isString(parentStateValue)) {\n      return childStateValue === parentStateValue;\n    } // Parent more specific than child\n\n\n    return false;\n  }\n\n  if (isString(parentStateValue)) {\n    return parentStateValue in childStateValue;\n  }\n\n  return keys(parentStateValue).every(function (key) {\n    if (!(key in childStateValue)) {\n      return false;\n    }\n\n    return matchesState(parentStateValue[key], childStateValue[key]);\n  });\n}\nfunction getEventType(event) {\n  try {\n    return isString(event) || typeof event === 'number' ? \"\" + event : event.type;\n  } catch (e) {\n    throw new Error('Events must be strings or objects with a string event.type property.');\n  }\n}\nfunction toStatePath(stateId, delimiter) {\n  try {\n    if (isArray(stateId)) {\n      return stateId;\n    }\n\n    return stateId.toString().split(delimiter);\n  } catch (e) {\n    throw new Error(\"'\" + stateId + \"' is not a valid state path.\");\n  }\n}\nfunction isStateLike(state) {\n  return typeof state === 'object' && 'value' in state && 'context' in state && 'event' in state && '_event' in state;\n}\nfunction toStateValue(stateValue, delimiter) {\n  if (isStateLike(stateValue)) {\n    return stateValue.value;\n  }\n\n  if (isArray(stateValue)) {\n    return pathToStateValue(stateValue);\n  }\n\n  if (typeof stateValue !== 'string') {\n    return stateValue;\n  }\n\n  var statePath = toStatePath(stateValue, delimiter);\n  return pathToStateValue(statePath);\n}\nfunction pathToStateValue(statePath) {\n  if (statePath.length === 1) {\n    return statePath[0];\n  }\n\n  var value = {};\n  var marker = value;\n\n  for (var i = 0; i < statePath.length - 1; i++) {\n    if (i === statePath.length - 2) {\n      marker[statePath[i]] = statePath[i + 1];\n    } else {\n      marker[statePath[i]] = {};\n      marker = marker[statePath[i]];\n    }\n  }\n\n  return value;\n}\nfunction mapValues(collection, iteratee) {\n  var result = {};\n  var collectionKeys = keys(collection);\n\n  for (var i = 0; i < collectionKeys.length; i++) {\n    var key = collectionKeys[i];\n    result[key] = iteratee(collection[key], key, collection, i);\n  }\n\n  return result;\n}\nfunction mapFilterValues(collection, iteratee, predicate) {\n  var e_1, _a;\n\n  var result = {};\n\n  try {\n    for (var _b = _tslib.__values(keys(collection)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var item = collection[key];\n\n      if (!predicate(item)) {\n        continue;\n      }\n\n      result[key] = iteratee(item, key, collection);\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return result;\n}\n/**\r\n * Retrieves a value at the given path.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\nvar path = function (props) {\n  return function (object) {\n    var e_2, _a;\n\n    var result = object;\n\n    try {\n      for (var props_1 = _tslib.__values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n        var prop = props_1_1.value;\n        result = result[prop];\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    return result;\n  };\n};\n/**\r\n * Retrieves a value at the given path via the nested accessor prop.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\nfunction nestedPath(props, accessorProp) {\n  return function (object) {\n    var e_3, _a;\n\n    var result = object;\n\n    try {\n      for (var props_2 = _tslib.__values(props), props_2_1 = props_2.next(); !props_2_1.done; props_2_1 = props_2.next()) {\n        var prop = props_2_1.value;\n        result = result[accessorProp][prop];\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (props_2_1 && !props_2_1.done && (_a = props_2.return)) _a.call(props_2);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    return result;\n  };\n}\nfunction toStatePaths(stateValue) {\n  if (!stateValue) {\n    return [[]];\n  }\n\n  if (isString(stateValue)) {\n    return [[stateValue]];\n  }\n\n  var result = flatten(keys(stateValue).map(function (key) {\n    var subStateValue = stateValue[key];\n\n    if (typeof subStateValue !== 'string' && (!subStateValue || !Object.keys(subStateValue).length)) {\n      return [[key]];\n    }\n\n    return toStatePaths(stateValue[key]).map(function (subPath) {\n      return [key].concat(subPath);\n    });\n  }));\n  return result;\n}\nfunction flatten(array) {\n  var _a;\n\n  return (_a = []).concat.apply(_a, _tslib.__spreadArray([], _tslib.__read(array)));\n}\nfunction toArrayStrict(value) {\n  if (isArray(value)) {\n    return value;\n  }\n\n  return [value];\n}\nfunction toArray(value) {\n  if (value === undefined) {\n    return [];\n  }\n\n  return toArrayStrict(value);\n}\nfunction mapContext(mapper, context, _event) {\n  var e_5, _a;\n\n  if (isFunction(mapper)) {\n    return mapper(context, _event.data);\n  }\n\n  var result = {};\n\n  try {\n    for (var _b = _tslib.__values(Object.keys(mapper)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var subMapper = mapper[key];\n\n      if (isFunction(subMapper)) {\n        result[key] = subMapper(context, _event.data);\n      } else {\n        result[key] = subMapper;\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return result;\n}\nfunction isBuiltInEvent(eventType) {\n  return /^(done|error)\\./.test(eventType);\n}\nfunction isPromiseLike(value) {\n  if (value instanceof Promise) {\n    return true;\n  } // Check if shape matches the Promise/A+ specification for a \"thenable\".\n\n\n  if (value !== null && (isFunction(value) || typeof value === 'object') && isFunction(value.then)) {\n    return true;\n  }\n\n  return false;\n}\nfunction isBehavior(value) {\n  return value !== null && typeof value === 'object' && 'transition' in value && typeof value.transition === 'function';\n}\nfunction partition(items, predicate) {\n  var e_6, _a;\n\n  var _b = _tslib.__read([[], []], 2),\n      truthy = _b[0],\n      falsy = _b[1];\n\n  try {\n    for (var items_1 = _tslib.__values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n      var item = items_1_1.value;\n\n      if (predicate(item)) {\n        truthy.push(item);\n      } else {\n        falsy.push(item);\n      }\n    }\n  } catch (e_6_1) {\n    e_6 = {\n      error: e_6_1\n    };\n  } finally {\n    try {\n      if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n    } finally {\n      if (e_6) throw e_6.error;\n    }\n  }\n\n  return [truthy, falsy];\n}\nfunction updateHistoryStates(hist, stateValue) {\n  return mapValues(hist.states, function (subHist, key) {\n    if (!subHist) {\n      return undefined;\n    }\n\n    var subStateValue = (isString(stateValue) ? undefined : stateValue[key]) || (subHist ? subHist.current : undefined);\n\n    if (!subStateValue) {\n      return undefined;\n    }\n\n    return {\n      current: subStateValue,\n      states: updateHistoryStates(subHist, subStateValue)\n    };\n  });\n}\nfunction updateHistoryValue(hist, stateValue) {\n  return {\n    current: stateValue,\n    states: updateHistoryStates(hist, stateValue)\n  };\n}\nfunction updateContext(context, _event, assignActions, state) {\n  if (!environment.IS_PRODUCTION) {\n    exports.warn(!!context, 'Attempting to update undefined context');\n  }\n\n  var updatedContext = context ? assignActions.reduce(function (acc, assignAction) {\n    var e_7, _a;\n\n    var assignment = assignAction.assignment;\n    var meta = {\n      state: state,\n      action: assignAction,\n      _event: _event\n    };\n    var partialUpdate = {};\n\n    if (isFunction(assignment)) {\n      partialUpdate = assignment(acc, _event.data, meta);\n    } else {\n      try {\n        for (var _b = _tslib.__values(keys(assignment)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var key = _c.value;\n          var propAssignment = assignment[key];\n          partialUpdate[key] = isFunction(propAssignment) ? propAssignment(acc, _event.data, meta) : propAssignment;\n        }\n      } catch (e_7_1) {\n        e_7 = {\n          error: e_7_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_7) throw e_7.error;\n        }\n      }\n    }\n\n    return Object.assign({}, acc, partialUpdate);\n  }, context) : context;\n  return updatedContext;\n} // tslint:disable-next-line:no-empty\n\nexports.warn = function () {};\n\nif (!environment.IS_PRODUCTION) {\n  exports.warn = function (condition, message) {\n    var error = condition instanceof Error ? condition : undefined;\n\n    if (!error && condition) {\n      return;\n    }\n\n    if (console !== undefined) {\n      var args = [\"Warning: \" + message];\n\n      if (error) {\n        args.push(error);\n      } // tslint:disable-next-line:no-console\n\n\n      console.warn.apply(console, args);\n    }\n  };\n}\nfunction isArray(value) {\n  return Array.isArray(value);\n} // tslint:disable-next-line:ban-types\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\nfunction isString(value) {\n  return typeof value === 'string';\n} // export function memoizedGetter<T, TP extends { prototype: object }>(\n//   o: TP,\n//   property: string,\n//   getter: () => T\n// ): void {\n//   Object.defineProperty(o.prototype, property, {\n//     get: getter,\n//     enumerable: false,\n//     configurable: false\n//   });\n// }\n\nfunction toGuard(condition, guardMap) {\n  if (!condition) {\n    return undefined;\n  }\n\n  if (isString(condition)) {\n    return {\n      type: constants.DEFAULT_GUARD_TYPE,\n      name: condition,\n      predicate: guardMap ? guardMap[condition] : undefined\n    };\n  }\n\n  if (isFunction(condition)) {\n    return {\n      type: constants.DEFAULT_GUARD_TYPE,\n      name: condition.name,\n      predicate: condition\n    };\n  }\n\n  return condition;\n}\nfunction isObservable(value) {\n  try {\n    return 'subscribe' in value && isFunction(value.subscribe);\n  } catch (e) {\n    return false;\n  }\n}\nvar symbolObservable = /*#__PURE__*/function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\nfunction isMachine(value) {\n  try {\n    return '__xstatenode' in value;\n  } catch (e) {\n    return false;\n  }\n}\nfunction isActor(value) {\n  return !!value && typeof value.send === 'function';\n}\nvar uniqueId = /*#__PURE__*/function () {\n  var currentId = 0;\n  return function () {\n    currentId++;\n    return currentId.toString(16);\n  };\n}();\nfunction toEventObject(event, payload // id?: TEvent['type']\n) {\n  if (isString(event) || typeof event === 'number') {\n    return _tslib.__assign({\n      type: event\n    }, payload);\n  }\n\n  return event;\n}\nfunction toSCXMLEvent(event, scxmlEvent) {\n  if (!isString(event) && '$$type' in event && event.$$type === 'scxml') {\n    return event;\n  }\n\n  var eventObject = toEventObject(event);\n  return _tslib.__assign({\n    name: eventObject.type,\n    data: eventObject,\n    $$type: 'scxml',\n    type: 'external'\n  }, scxmlEvent);\n}\nfunction toTransitionConfigArray(event, configLike) {\n  var transitions = toArrayStrict(configLike).map(function (transitionLike) {\n    if (typeof transitionLike === 'undefined' || typeof transitionLike === 'string' || isMachine(transitionLike)) {\n      return {\n        target: transitionLike,\n        event: event\n      };\n    }\n\n    return _tslib.__assign(_tslib.__assign({}, transitionLike), {\n      event: event\n    });\n  });\n  return transitions;\n}\nfunction normalizeTarget(target) {\n  if (target === undefined || target === constants.TARGETLESS_KEY) {\n    return undefined;\n  }\n\n  return toArray(target);\n}\nfunction reportUnhandledExceptionOnInvocation(originalError, currentError, id) {\n  if (!environment.IS_PRODUCTION) {\n    var originalStackTrace = originalError.stack ? \" Stacktrace was '\" + originalError.stack + \"'\" : '';\n\n    if (originalError === currentError) {\n      // tslint:disable-next-line:no-console\n      console.error(\"Missing onError handler for invocation '\" + id + \"', error was '\" + originalError + \"'.\" + originalStackTrace);\n    } else {\n      var stackTrace = currentError.stack ? \" Stacktrace was '\" + currentError.stack + \"'\" : ''; // tslint:disable-next-line:no-console\n\n      console.error(\"Missing onError handler and/or unhandled exception/promise rejection for invocation '\" + id + \"'. \" + (\"Original error: '\" + originalError + \"'. \" + originalStackTrace + \" Current error is '\" + currentError + \"'.\" + stackTrace));\n    }\n  }\n}\nfunction evaluateGuard(machine, guard, context, _event, state) {\n  var guards = machine.options.guards;\n  var guardMeta = {\n    state: state,\n    cond: guard,\n    _event: _event\n  }; // TODO: do not hardcode!\n\n  if (guard.type === constants.DEFAULT_GUARD_TYPE) {\n    return ((guards === null || guards === void 0 ? void 0 : guards[guard.name]) || guard.predicate)(context, _event.data, guardMeta);\n  }\n\n  var condFn = guards[guard.type];\n\n  if (!condFn) {\n    throw new Error(\"Guard '\" + guard.type + \"' is not implemented on machine '\" + machine.id + \"'.\");\n  }\n\n  return condFn(context, _event.data, guardMeta);\n}\nfunction toInvokeSource(src) {\n  if (typeof src === 'string') {\n    return {\n      type: src\n    };\n  }\n\n  return src;\n}\nfunction toObserver(nextHandler, errorHandler, completionHandler) {\n  if (typeof nextHandler === 'object') {\n    return nextHandler;\n  }\n\n  var noop = function () {\n    return void 0;\n  };\n\n  return {\n    next: nextHandler,\n    error: errorHandler || noop,\n    complete: completionHandler || noop\n  };\n}\n\nexports.evaluateGuard = evaluateGuard;\nexports.flatten = flatten;\nexports.getEventType = getEventType;\nexports.isActor = isActor;\nexports.isArray = isArray;\nexports.isBehavior = isBehavior;\nexports.isBuiltInEvent = isBuiltInEvent;\nexports.isFunction = isFunction;\nexports.isMachine = isMachine;\nexports.isObservable = isObservable;\nexports.isPromiseLike = isPromiseLike;\nexports.isStateLike = isStateLike;\nexports.isString = isString;\nexports.keys = keys;\nexports.mapContext = mapContext;\nexports.mapFilterValues = mapFilterValues;\nexports.mapValues = mapValues;\nexports.matchesState = matchesState;\nexports.nestedPath = nestedPath;\nexports.normalizeTarget = normalizeTarget;\nexports.partition = partition;\nexports.path = path;\nexports.pathToStateValue = pathToStateValue;\nexports.reportUnhandledExceptionOnInvocation = reportUnhandledExceptionOnInvocation;\nexports.symbolObservable = symbolObservable;\nexports.toArray = toArray;\nexports.toArrayStrict = toArrayStrict;\nexports.toEventObject = toEventObject;\nexports.toGuard = toGuard;\nexports.toInvokeSource = toInvokeSource;\nexports.toObserver = toObserver;\nexports.toSCXMLEvent = toSCXMLEvent;\nexports.toStatePath = toStatePath;\nexports.toStatePaths = toStatePaths;\nexports.toStateValue = toStateValue;\nexports.toTransitionConfigArray = toTransitionConfigArray;\nexports.uniqueId = uniqueId;\nexports.updateContext = updateContext;\nexports.updateHistoryStates = updateHistoryStates;\nexports.updateHistoryValue = updateHistoryValue;\n"]},"metadata":{},"sourceType":"script"}